{"version":3,"sources":["../../src/routes/rides.js"],"names":["rideCreateSuccess","message","rideRequestSuccess","error","status","ridesRouter","express","Router","verifyParameters","req","res","next","parameter","body","destination","takeOffTime","totalSeats","send","get","rideOffers","rideId","params","id","forEach","item","post","reqBody","newRide","requests","push","isAdded","name"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,oBAAoB,EAAEC,SAAS,0CAAX,EAA1B;AACA,IAAMC,qBAAqB,EAAED,SAAS,+BAAX,EAA3B;AACA,IAAME,QAAQ;AACZA,SAAO,EADK;AAEZC,UAAQ;AAFI,CAAd;AAIA,IAAMC,cAAcC,kBAAQC,MAAR,EAApB;AACA,IAAMC,mBAAmB,SAAnBA,gBAAmB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAMC,YAAYH,IAAII,IAAtB;AACA,MAAID,aAAaA,UAAUE,WAAvB,IAAsCF,UAAUG,WAAhD,IAA+DH,UAAUI,UAA7E,EAAyF;AACvFL;AACD,GAFD,MAEO;AACLR,UAAMA,KAAN,GAAc,0CAAd;AACAA,UAAMC,MAAN,GAAe,GAAf;AACAM,QAAIN,MAAJ,CAAW,GAAX,EAAgBa,IAAhB,CAAqBd,KAArB;AACD;AACF,CATD;;AAWAE,YAAYa,GAAZ,CAAgB,GAAhB,EAAqB,UAACT,GAAD,EAAMC,GAAN,EAAc;AACjCA,MAAIO,IAAJ,CAASE,oBAAT;AACD,CAFD;;AAIAd,YAAYa,GAAZ,CAAgB,MAAhB,EAAwB,UAACT,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1C,MAAMS,SAASX,IAAIY,MAAJ,CAAWC,EAA1B;AACAH,uBAAWI,OAAX,CAAmB,UAACC,IAAD,EAAU;AAC3B,QAAIA,KAAKF,EAAL,KAAYF,MAAhB,EAAwB;AACtBV,UAAIO,IAAJ,CAASO,IAAT;AACD;AACF,GAJD;AAKArB,QAAMA,KAAN,GAAc,cAAd;AACAA,QAAMC,MAAN,GAAe,GAAf;AACAO,OAAKR,KAAL;AACD,CAVD;;AAYAE,YAAYoB,IAAZ,CAAiB,GAAjB,EAAsBjB,gBAAtB,EAAwC,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1D,MAAMe,UAAUjB,IAAII,IAApB;AACA,MAAMc,UAAU;AACdL,QAAI,uBADU;AAEdR,iBAAaY,QAAQZ,WAFP;AAGdC,iBAAaW,QAAQX,WAHP;AAIdC,gBAAYU,QAAQV,UAJN;AAKdY,cAAU;AALI,GAAhB;AAOA,MAAIT,qBAAWU,IAAX,CAAgBF,OAAhB,CAAJ,EAA8B;AAC5BjB,QAAIO,IAAJ,CAASjB,iBAAT;AACD,GAFD,MAEO;AACLG,UAAMA,KAAN,GAAc,0BAAd;AACAA,UAAMC,MAAN,GAAe,GAAf;AACAO,SAAKR,KAAL;AACD;AACF,CAhBD;;AAkBAE,YAAYoB,IAAZ,CAAiB,eAAjB,EAAkC,UAAChB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACpD,MAAMe,UAAUjB,IAAII,IAApB;AACA,MAAMO,SAASX,IAAIY,MAAJ,CAAWC,EAA1B;AACA,MAAIQ,UAAU,KAAd;AACA,MAAIJ,QAAQK,IAAZ,EAAkB;AAChBZ,yBAAWI,OAAX,CAAmB,UAACC,IAAD,EAAU;AAC3B,UAAIA,KAAKF,EAAL,KAAYF,MAAhB,EAAwB;AACtBI,aAAKI,QAAL,CAAcC,IAAd,CAAmBH,QAAQK,IAA3B;AACAD,kBAAU,IAAV;AACD;AACF,KALD;AAMA,QAAIA,OAAJ,EAAa;AACXpB,UAAIO,IAAJ,CAASf,kBAAT;AACD,KAFD,MAEO;AACLC,YAAMA,KAAN,GAAc,cAAd;AACAA,YAAMC,MAAN,GAAe,GAAf;AACAO,WAAKR,KAAL;AACD;AACF,GAdD,MAcO;AACLA,UAAMA,KAAN,GAAc,kDAAd;AACAA,UAAMC,MAAN,GAAe,GAAf;AACAO,SAAKR,KAAL;AACD;AACF,CAvBD;;kBA0BeE,W","file":"rides.js","sourcesContent":["import express from 'express';\r\nimport uniqid from 'uniqid';\r\nimport rideOffers from '../models/rideOffers';\r\n\r\nconst rideCreateSuccess = { message: 'Your offer has been successfully created' };\r\nconst rideRequestSuccess = { message: 'Your request has been created' };\r\nconst error = {\r\n  error: '',\r\n  status: 401,\r\n};\r\nconst ridesRouter = express.Router();\r\nconst verifyParameters = (req, res, next) => {\r\n  const parameter = req.body;\r\n  if (parameter && parameter.destination && parameter.takeOffTime && parameter.totalSeats) {\r\n    next();\r\n  } else {\r\n    error.error = 'Please input all the required parameters';\r\n    error.status = 400;\r\n    res.status(400).send(error);\r\n  }\r\n};\r\n\r\nridesRouter.get('/', (req, res) => {\r\n  res.send(rideOffers);\r\n});\r\n\r\nridesRouter.get('/:id', (req, res, next) => {\r\n  const rideId = req.params.id;\r\n  rideOffers.forEach((item) => {\r\n    if (item.id === rideId) {\r\n      res.send(item);\r\n    }\r\n  });\r\n  error.error = 'Invalid ride';\r\n  error.status = 404;\r\n  next(error);\r\n});\r\n\r\nridesRouter.post('/', verifyParameters, (req, res, next) => {\r\n  const reqBody = req.body;\r\n  const newRide = {\r\n    id: uniqid(),\r\n    destination: reqBody.destination,\r\n    takeOffTime: reqBody.takeOffTime,\r\n    totalSeats: reqBody.totalSeats,\r\n    requests: [],\r\n  };\r\n  if (rideOffers.push(newRide)) {\r\n    res.send(rideCreateSuccess);\r\n  } else {\r\n    error.error = 'An unknown error occured';\r\n    error.status = 500;\r\n    next(error);\r\n  }\r\n});\r\n\r\nridesRouter.post('/:id/requests', (req, res, next) => {\r\n  const reqBody = req.body;\r\n  const rideId = req.params.id;\r\n  let isAdded = false;\r\n  if (reqBody.name) {\r\n    rideOffers.forEach((item) => {\r\n      if (item.id === rideId) {\r\n        item.requests.push(reqBody.name);\r\n        isAdded = true;\r\n      }\r\n    });\r\n    if (isAdded) {\r\n      res.send(rideRequestSuccess);\r\n    } else {\r\n      error.error = 'Invalid ride';\r\n      error.status = 404;\r\n      next(error);\r\n    }\r\n  } else {\r\n    error.error = 'Please append the name parameter in your request';\r\n    error.status = 400;\r\n    next(error);\r\n  }\r\n});\r\n\r\n\r\nexport default ridesRouter;\r\n"]}